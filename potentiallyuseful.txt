// API route to retrieve all games with filtering, sorting, pagination, and search
app.get("/games", (req, res) => {
    let filteredGames = [...games];

    // Search by keyword in the title
    if (req.query.search) {
        const searchKeyword = req.query.search.toLowerCase();
        filteredGames = filteredGames.filter((game) => game.title.toLowerCase().includes(searchKeyword));
    }

    // Filter by genre
    if (req.query.genre) {
        const genre = req.query.genre;
        filteredGames = filteredGames.filter((game) => game.genres.includes(genre));
    }

    // Sort by title or rating
    if (req.query.sort) {
        const sortBy = req.query.sort;
        filteredGames.sort((a, b) => {
            if (sortBy === "title") {
                return a.title.localeCompare(b.title);
            } else if (sortBy === "rating") {
                return b.rating - a.rating;
            }
        });
    }

    // Pagination
    const page = parseInt(req.query.page) || 1;
    const limit = parseInt(req.query.limit) || 5;
    const startIndex = (page - 1) * limit;
    const endIndex = page * limit;

    const paginatedGames = filteredGames.slice(startIndex, endIndex);

    res.status(200).send(paginatedGames);
});